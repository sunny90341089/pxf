apply plugin: "java-library"

jar {
    enabled = true
}

dependencies {
    /*******************************
     * API Dependencies
     *******************************/

    api(project(':pxf-api'))
    api("org.apache.hadoop:hadoop-mapreduce-client-core:${hadoopVersion}") { transitive = false }

    /*******************************
     * Compile Only Dependencies
     *******************************/

    compileOnly("org.apache.hadoop:hadoop-annotations:${hadoopVersion}") { transitive = false }

    /*******************************
     * Implementation Dependencies
     *******************************/

    implementation("com.google.guava:guava")
    implementation("commons-configuration:commons-configuration")
    implementation("commons-io:commons-io")
    implementation("commons-lang:commons-lang")
    implementation("org.apache.commons:commons-lang3")
    implementation("org.slf4j:slf4j-api")

    implementation("org.apache.avro:avro-mapred:1.7.7") { transitive = false }
    implementation("com.fasterxml.jackson.core:jackson-databind") { transitive = false }
    implementation("com.fasterxml.jackson.core:jackson-core") { transitive = false }
    implementation("com.fasterxml.jackson.core:jackson-annotations") { transitive = false }
    implementation("org.apache.hadoop:hadoop-yarn-api:${hadoopVersion}") { transitive = false } // Kerberos dependency
    implementation("org.apache.hadoop:hadoop-yarn-client:${hadoopVersion}") { transitive = false } // Kerberos dependency
    implementation("org.apache.hadoop:hadoop-common:${hadoopVersion}") { transitive = false }
    implementation("org.apache.htrace:htrace-core4:${htraceVersion}") { transitive = false }
    implementation("org.apache.hadoop:hadoop-hdfs:${hadoopVersion}") { transitive = false }
    implementation("org.apache.hadoop:hadoop-hdfs-client:${hadoopVersion}") { transitive = false }
    implementation("org.apache.parquet:parquet-format:2.7.0") { transitive = false }
    implementation("org.apache.parquet:parquet-column:${parquetVersion}") { transitive = false }
    implementation("org.apache.parquet:parquet-common:${parquetVersion}") { transitive = false }
    implementation("org.apache.parquet:parquet-encoding:${parquetVersion}") { transitive = false }
    implementation("org.apache.parquet:parquet-generator:${parquetVersion}") { transitive = false }
    implementation("org.apache.parquet:parquet-hadoop:${parquetVersion}") { transitive = false }
    implementation("org.apache.hive:hive-storage-api:2.4.0") { transitive = false }// for parquet writing

    implementation("org.codehaus.jackson:jackson-core-asl:1.9.13") { transitive = false }
    implementation("org.codehaus.jackson:jackson-mapper-asl:1.9.13") { transitive = false }

    implementation("org.apache.avro:avro:1.7.7")                  { transitive = false }
    // Dependency in hadoop 2.9.2
    implementation("log4j:log4j:1.2.17")                         { transitive = false }
    implementation("com.fasterxml.woodstox:woodstox-core:5.0.3") { transitive = false }
    implementation("org.codehaus.woodstox:stax2-api:3.1.4")      { transitive = false }

    /*******************************
     * Dependencies for Supported Hadoop-Compatible Filesystems
     *******************************/

    // Azure Data Blob
    implementation("org.apache.hadoop:hadoop-azure:${hadoopVersion}")  { transitive = false }
    implementation("com.microsoft.azure:azure-storage:5.4.0")          { transitive = false }

    // Azure Datalake jars
    implementation("org.apache.hadoop:hadoop-azure-datalake:${hadoopVersion}") { transitive = false }
    implementation("com.microsoft.azure:azure-data-lake-store-sdk:2.2.3")      { transitive = false }

    // GCS jars and dependencies
    implementation("com.google.cloud.bigdataoss:gcs-connector:hadoop2-1.9.17:shaded") { transitive = false }

    /*******************************
     * Test Dependencies
     *******************************/

    testCompileOnly("org.apache.hadoop:hadoop-annotations:${hadoopVersion}")

    // for parquet tests
    testImplementation("org.apache.parquet:parquet-pig:${parquetVersion}")

    testImplementation('org.springframework.boot:spring-boot-starter-test') {
        exclude group: 'org.junit.vintage', module: 'junit-vintage-engine'
    }

}

test {
    useJUnitPlatform()
}
